
Below is an auto-generated summary of the contents of a Dandiset. It includes both metadata and a summary of the contents of the NWB files.

Please summarize the experiment in two or three paragraphs in the style of a scientific abstract touching on the likely purpose of the experiment.

Then give a description of what data are available in the NWB files.

Finally provide a list of up to ten keywords.

You should not refer to "Type X" since these are just internal labels used for communicating the breakdown of NWB files.

The summaries are from representative NWB files for each type, so keep that in mind when making your description. So for example, the timestamp or session ID is not going to be representative of all NWB files of that type.

Please provide your response in raw markdown suitable for copy/paste into a .md document.


id: DANDI:000776/0.240625.0022
name: Brain-wide representations of behavior spanning multiple timescales and states in C. elegans
contributor: [{'name': 'Atanas, Adam', 'roleName': ['dcite:ProjectLeader'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Kim, Jungsoo', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Wang, Ziyu', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Bueno, Eric', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Becker, McCoy', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Kang, Di', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Park, Jungyeon', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Kramer, Talya', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Wan, Flossie', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Baskoylu, Saba', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Dag, Ugur', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Kalogeropoulou, Elpiniki', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Gomes, Matthew', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Estrem, Cassi', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Sprague, Daniel', 'email': 'daniel.y.sprague@gmail.com', 'roleName': ['dcite:ContactPerson'], 'schemaKey': 'Person', 'affiliation': [], 'includeInCitation': True}, {'name': 'Cohen, Netta', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Mansinghka, Vikash', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': True}, {'name': 'Flavell, Steve', 'roleName': ['dcite:ProjectMember'], 'schemaKey': 'Person', 'includeInCitation': False}]
description: Dataset of 38 worms from 'Brain-wide representations of behavior spanning multiple timescales and states in C. elegans'. Each NWB file contains the NIR bright-field images, GCaMP images, and NeuroPAL structural images, ROI locations and IDs, labeled activity traces, and behavioral information. 

assetsSummary: {'species': [{'name': 'Caenorhabditis elegans', 'schemaKey': 'SpeciesType', 'identifier': 'http://purl.obolibrary.org/obo/NCBITaxon_6239'}], 'approach': [{'name': 'microscopy approach; cell population imaging', 'schemaKey': 'ApproachType'}, {'name': 'behavioral approach', 'schemaKey': 'ApproachType'}], 'schemaKey': 'AssetsSummary', 'dataStandard': [{'name': 'Neurodata Without Borders (NWB)', 'schemaKey': 'StandardsType', 'identifier': 'RRID:SCR_015242'}], 'numberOfBytes': 1011743300552, 'numberOfFiles': 38, 'numberOfSubjects': 38, 'variableMeasured': ['ProcessingModule', 'BehavioralTimeSeries', 'PlaneSegmentation', 'BehavioralEvents'], 'measurementTechnique': [{'name': 'analytical technique', 'schemaKey': 'MeasurementTechniqueType'}, {'name': 'behavioral technique', 'schemaKey': 'MeasurementTechniqueType'}]}

Dandiset 000776 has 38 NWB files.
20 of these NWB files are of type 1.
18 of these NWB files are of type 2.


Here is a summary of the type 1 NWB files:
  Group / (NWBFile) 
  Group /acquisition/CalciumImageSeries (MultiChannelVolumeSeries) GCaMP6s series images. Dimensions should be (t, x, y, z, C).
  Group /acquisition/CalciumImageSeries/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/CalciumImageSeries/imaging_volume (ImagingVolume) 
  Group /acquisition/CalciumImageSeries/imaging_volume/GCaMP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/OFP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/TagRFP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/CalciumImageSeries/imaging_volume/mNeptune (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/order_optical_channels (OpticalChannelReferences) 
  Group /acquisition/NeuroPALImageRaw (MultiChannelVolume) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume (ImagingVolume) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/GCaMP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/OFP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/TagRFP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/NeuroPALImageRaw/imaging_volume/mNeptune (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/order_optical_channels (OpticalChannelReferences) 
  file_create_date: ['2024-06-12T17:41:47.896644-07:00']
  Group /general/devices/NIR Config (Device) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /general/devices/Spinning Disk Confocal (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  institution: MIT
  lab: Flavell Laboratory
  Group /general/optophysiology/CalciumImVol (ImagingVolume) 
  Group /general/optophysiology/CalciumImVol/GCaMP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/OFP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/TagRFP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /general/optophysiology/CalciumImVol/mNeptune (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/order_optical_channels (OpticalChannelReferences) 
  Group /general/optophysiology/NeuroPALImVol (ImagingVolume) 
  Group /general/optophysiology/NeuroPALImVol/GCaMP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/OFP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/TagRFP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /general/optophysiology/NeuroPALImVol/mNeptune (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/order_optical_channels (OpticalChannelReferences) 
  related_publications: ['https://doi.org/10.1016/j.cell.2023.07.035']
  Group /general/subject (CElegansSubject) 
  identifier: 2022-06-14-01
  Group /processing/BF_NIR (ProcessingModule) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /processing/BF_NIR/BrightFieldNIR (ImageSeries) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /processing/Behavior (ProcessingModule) Behavioral data
  Group /processing/Behavior/angular_velocity (BehavioralTimeSeries) 
  Group /processing/Behavior/angular_velocity/angular_velocity (TimeSeries) Angular velocity is computed as smoothed (dθ→_1,2)/(dt) , which is computed with a linear Savitzky-Golay filter with a width of 300 time points (15 seconds) centered on the current time point.
  Group /processing/Behavior/body_curvature (BehavioralTimeSeries) 
  Group /processing/Behavior/body_curvature/body_curvature (TimeSeries) Body curvature is computed as the standard deviation of θ→_(i, i+1) for i between 1 and 31 (ie: going up to 265 μm along the worm’s spline). This value was selected such that this length of the animal would almost never be cropped out of the NIR camera’s field of view. To ensure that these angles are continuous in i , they may each have 2pi added or subtracted as appropriate.
  Group /processing/Behavior/dorsalness (BehavioralTimeSeries) 
  Group /processing/Behavior/dorsalness/dorsalness (TimeSeries) The dorsalness metric is computed similarly to the forwardness metric.
  Group /processing/Behavior/feedingness (BehavioralTimeSeries) 
  Group /processing/Behavior/feedingness/feedingness (TimeSeries) The feedingness metric is computed similarly to the forwardness metric.
  Group /processing/Behavior/forwardness (BehavioralTimeSeries) 
  Group /processing/Behavior/forwardness/forwardness (TimeSeries) The forwardness metric for a neuron class is computed as F_D * (σM/σD) * signal, where F_D is the deconvolved forwardness of the Cartesian average μ_cart of the hierarchical model fit to that neuron class (see “deconvolved activity matrix” and “hierarchical model” methods sections above for more details; the behavior values used in the deconvolved forwardness computation were constructed by appending together all of the behaviors for the neuron class), σD is the standard deviation of the model fit corresponding to μ_cart with s = 0, σM is the standard deviation of the model fit corresponding to μ_cart, σD, and signal is defined as in the “Statistical encoding tests” section of the related publication. This ratio is intended to correct for the fact that the model parameters need to be larger (resulting in larger deconvolved forwardness values) for the same neural response size if the neuron has a long EWMA decay.
  Group /processing/Behavior/head_curvature (BehavioralTimeSeries) 
  Group /processing/Behavior/head_curvature/head_curvature (TimeSeries) Head curvature is computed as the angle between the points 1, 5, and 8 (ie: the angle between θ→_1,5 and θ→_5,8 ). These points are 0 μm, 35.4 μm, and 61.9 μm along the worm’s spline, respectively.
  Group /processing/Behavior/pumping (BehavioralTimeSeries) 
  Group /processing/Behavior/pumping/pumping (TimeSeries) Pumping rate was manually annotated using Datavyu, by counting each pumping stroke while watching videos slowed down the 25% of their real-time speeds. The rate is then filtered via a moving average with a width of 80 time points (4 seconds) to smoothen the trace into a pumping rate rather than individual pumping strokes.
  Group /processing/Behavior/reversal_events (BehavioralEvents) 
  Group /processing/Behavior/reversal_events/reversal_events (TimeSeries) 
  Group /processing/Behavior/velocity (BehavioralTimeSeries) 
  Group /processing/Behavior/velocity/velocity (TimeSeries) First, we read out the (x,y) position of the stage (in mm) as it tracks the worm. To account for any delay between the worm’s motion and stage tracking, at each time point we added the distance from the center of the image (corresponding to the stage position) to the position of the metacorpus of pharynx (detected from our neural network used in tracking). This then gave us the position of the metacorpus over time. To decrease the noise level (e.g., from neural network and stage jitter), we then applied a Group-Sparse Total-Variation Denoising algorithm to the metacorpus position. Differentiating the metacorpus position then gives us a movement vector of the animal. Because this movement vector was computed from the location of the metacorpus, it contains two components of movement: the animal’s velocity in its direction of motion, and oscillations of the animal’s head perpendicular to that direction. To filter out these oscillations, we projected the movement vector onto the animal’s facing direction, i.e. the vector from the grinder of the pharynx to its metacorpus (computed from the stage-tracking neural network output). The result of this projection is a signed scalar, which is reported as the animal’s velocity.
  Group /processing/CalciumActivity (ProcessingModule) Calcium time series metadata, segmentation, and fluorescence data
  Group /processing/CalciumActivity/CalciumSeriesSegmentation (ImageSegmentation) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates (PlaneSegmentation) Neuron center coordinates in aligned space
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/ID_labels (VectorData) Neuron Names | shape = (109,) | dtype = object
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/id (ElementIdentifiers)  | shape = (109,) | dtype = int64
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane (ImagingVolume) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/voxel_mask (VectorData) Voxel masks for each ROI | shape = (109,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (109,) | dtype = uint8
  Group /processing/CalciumActivity/NeuronIDs (SegmentationLabels) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation (ImageSegmentation) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates (PlaneSegmentation) Neuron center coordinates in aligned space
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/ID_labels (VectorData) Neuron Names | shape = (109,) | dtype = object
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/id (ElementIdentifiers)  | shape = (109,) | dtype = int64
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane (ImagingVolume) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/voxel_mask (VectorData) Voxel masks for each ROI | shape = (109,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (109,) | dtype = uint8
  Group /processing/CalciumActivity/SignalCalciumImResponseSeries (RoiResponseSeries) Raw calcium fluorescence activity
  Dataset /processing/CalciumActivity/SignalCalciumImResponseSeries/rois (DynamicTableRegion) Segmented neurons associated with calcium image series | shape = (109,) | dtype = int64
  Group /processing/CalciumActivity/SignalRawFluor (Fluorescence) 
  Group /processing/CalciumActivity/SignalRawFluor/SignalCalciumImResponseSeries (RoiResponseSeries) Raw calcium fluorescence activity
  Dataset /processing/CalciumActivity/SignalRawFluor/SignalCalciumImResponseSeries/rois (DynamicTableRegion) Segmented neurons associated with calcium image series | shape = (109,) | dtype = int64
  Group /processing/NeuroPAL (ProcessingModule) NeuroPAL image metadata and segmentation
  Group /processing/NeuroPAL/NeuroPALSegmentation (ImageSegmentation) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons (PlaneSegmentation) Centers of NeuroPAL volume.
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/ID_labels (VectorData) Neuron Names | shape = (79,) | dtype = object
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/ROI_IDs (VectorData) ROI ID labels from segmentation image mask. | shape = (79,) | dtype = int64
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/id (ElementIdentifiers)  | shape = (79,) | dtype = int64
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane (ImagingVolume) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/voxel_mask (VectorData) Voxel masks for each ROI | shape = (79,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (79,) | dtype = uint8
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs (PlaneSegmentation) Segmentation of NeuroPAL volume. IDs found in NeuroPALNeurons.
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/id (ElementIdentifiers)  | shape = (1,) | dtype = int64
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/image_mask (VectorData) Image masks for each ROI | shape = (1, 236, 97, 63) | dtype = uint16
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane (ImagingVolume) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  session_description: Ventral cord at the bottom when head points to the left on confocal images (what the neuronal manual suggests)
  Young adult with a few mature eggs
  Some pumps here and there
  Coiling for ~5 loops at t~220, coiling for ~5 loops again at t~510, coiling again for ~5 loop at t~810, coiling briefly again t ~1100, long coiling ~8 loops at t~1400, long coiling again t~1550
  The second half is slightly out of focus (the edge of 3-5 neurons at the upper border in z-dimension), should not affect registration in candy’s experience
  
  session_start_time: 2022-06-14T00:00:00-07:00
  timestamps_reference_time: 2022-06-14T00:00:00-07:00


Here is a summary of the type 2 NWB files:
  Group / (NWBFile) 
  Group /acquisition/CalciumImageSeries (MultiChannelVolumeSeries) GCaMP6s series images. Dimensions should be (t, x, y, z, C).
  Group /acquisition/CalciumImageSeries/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/CalciumImageSeries/imaging_volume (ImagingVolume) 
  Group /acquisition/CalciumImageSeries/imaging_volume/GCaMP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/OFP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/TagRFP (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/CalciumImageSeries/imaging_volume/mNeptune (OpticalChannelPlus) 
  Group /acquisition/CalciumImageSeries/imaging_volume/order_optical_channels (OpticalChannelReferences) 
  Group /acquisition/NeuroPALImageRaw (MultiChannelVolume) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume (ImagingVolume) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/GCaMP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/OFP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/TagRFP (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /acquisition/NeuroPALImageRaw/imaging_volume/mNeptune (OpticalChannelPlus) 
  Group /acquisition/NeuroPALImageRaw/imaging_volume/order_optical_channels (OpticalChannelReferences) 
  file_create_date: ['2024-06-12T16:12:11.541451-07:00']
  Group /general/devices/NIR Config (Device) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /general/devices/Spinning Disk Confocal (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  institution: MIT
  lab: Flavell Laboratory
  Group /general/optophysiology/CalciumImVol (ImagingVolume) 
  Group /general/optophysiology/CalciumImVol/GCaMP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/OFP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/TagRFP (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /general/optophysiology/CalciumImVol/mNeptune (OpticalChannelPlus) 
  Group /general/optophysiology/CalciumImVol/order_optical_channels (OpticalChannelReferences) 
  Group /general/optophysiology/NeuroPALImVol (ImagingVolume) 
  Group /general/optophysiology/NeuroPALImVol/GCaMP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/OFP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/TagRFP (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /general/optophysiology/NeuroPALImVol/mNeptune (OpticalChannelPlus) 
  Group /general/optophysiology/NeuroPALImVol/order_optical_channels (OpticalChannelReferences) 
  related_publications: ['https://doi.org/10.1016/j.cell.2023.07.035']
  Group /general/subject (CElegansSubject) 
  identifier: 2022-12-21-06
  Group /intervals/heat_stimulus (TimeIntervals) Heat stimulation driven by 1436-nm 500-mW laser. Mean temperature set to be 10.0C over first second of stimulation with a 0.39 sec exponential decay, returning to baseline within 3 sec. Start and stop time are in seconds.
  Dataset /intervals/heat_stimulus/id (ElementIdentifiers)  | shape = (1,) | dtype = int64
  Dataset /intervals/heat_stimulus/start_time (VectorData) Start time of epoch, in seconds | shape = (1,) | dtype = float64
  Dataset /intervals/heat_stimulus/stimulus (VectorData) which stimulus is active | shape = (1,) | dtype = object
  Dataset /intervals/heat_stimulus/stop_time (VectorData) Stop time of epoch, in seconds | shape = (1,) | dtype = float64
  Group /processing/BF_NIR (ProcessingModule) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /processing/BF_NIR/BrightFieldNIR (ImageSeries) The light path used to image behavior was in a reflected brightfield (NIR) configuration. Light supplied by an 850-nm LED (M850L3, Thorlabs) was collimated and passed through an 850/10 bandpass filter (FBH850-10, Thorlabs). Illumination light was reflected towards the sample by a half mirror and was focused on the sample through a 10x objective (CFI Plan Fluor 10x, Nikon). The image from the sample passed through the half mirror and was filtered by another 850-nm bandpass filter of the same model. The image was captured by a CMOS camera (BFS-U3-28S5M-C, FLIR).
  Group /processing/Behavior (ProcessingModule) Behavioral data
  Group /processing/Behavior/angular_velocity (BehavioralTimeSeries) 
  Group /processing/Behavior/angular_velocity/angular_velocity (TimeSeries) Angular velocity is computed as smoothed (dθ→_1,2)/(dt) , which is computed with a linear Savitzky-Golay filter with a width of 300 time points (15 seconds) centered on the current time point.
  Group /processing/Behavior/body_curvature (BehavioralTimeSeries) 
  Group /processing/Behavior/body_curvature/body_curvature (TimeSeries) Body curvature is computed as the standard deviation of θ→_(i, i+1) for i between 1 and 31 (ie: going up to 265 μm along the worm’s spline). This value was selected such that this length of the animal would almost never be cropped out of the NIR camera’s field of view. To ensure that these angles are continuous in i , they may each have 2pi added or subtracted as appropriate.
  Group /processing/Behavior/dorsalness (BehavioralTimeSeries) 
  Group /processing/Behavior/dorsalness/dorsalness (TimeSeries) The dorsalness metric is computed similarly to the forwardness metric.
  Group /processing/Behavior/feedingness (BehavioralTimeSeries) 
  Group /processing/Behavior/feedingness/feedingness (TimeSeries) The feedingness metric is computed similarly to the forwardness metric.
  Group /processing/Behavior/forwardness (BehavioralTimeSeries) 
  Group /processing/Behavior/forwardness/forwardness (TimeSeries) The forwardness metric for a neuron class is computed as F_D * (σM/σD) * signal, where F_D is the deconvolved forwardness of the Cartesian average μ_cart of the hierarchical model fit to that neuron class (see “deconvolved activity matrix” and “hierarchical model” methods sections above for more details; the behavior values used in the deconvolved forwardness computation were constructed by appending together all of the behaviors for the neuron class), σD is the standard deviation of the model fit corresponding to μ_cart with s = 0, σM is the standard deviation of the model fit corresponding to μ_cart, σD, and signal is defined as in the “Statistical encoding tests” section of the related publication. This ratio is intended to correct for the fact that the model parameters need to be larger (resulting in larger deconvolved forwardness values) for the same neural response size if the neuron has a long EWMA decay.
  Group /processing/Behavior/head_curvature (BehavioralTimeSeries) 
  Group /processing/Behavior/head_curvature/head_curvature (TimeSeries) Head curvature is computed as the angle between the points 1, 5, and 8 (ie: the angle between θ→_1,5 and θ→_5,8 ). These points are 0 μm, 35.4 μm, and 61.9 μm along the worm’s spline, respectively.
  Group /processing/Behavior/pumping (BehavioralTimeSeries) 
  Group /processing/Behavior/pumping/pumping (TimeSeries) Pumping rate was manually annotated using Datavyu, by counting each pumping stroke while watching videos slowed down the 25% of their real-time speeds. The rate is then filtered via a moving average with a width of 80 time points (4 seconds) to smoothen the trace into a pumping rate rather than individual pumping strokes.
  Group /processing/Behavior/reversal_events (BehavioralEvents) 
  Group /processing/Behavior/reversal_events/reversal_events (TimeSeries) 
  Group /processing/Behavior/velocity (BehavioralTimeSeries) 
  Group /processing/Behavior/velocity/velocity (TimeSeries) First, we read out the (x,y) position of the stage (in mm) as it tracks the worm. To account for any delay between the worm’s motion and stage tracking, at each time point we added the distance from the center of the image (corresponding to the stage position) to the position of the metacorpus of pharynx (detected from our neural network used in tracking). This then gave us the position of the metacorpus over time. To decrease the noise level (e.g., from neural network and stage jitter), we then applied a Group-Sparse Total-Variation Denoising algorithm to the metacorpus position. Differentiating the metacorpus position then gives us a movement vector of the animal. Because this movement vector was computed from the location of the metacorpus, it contains two components of movement: the animal’s velocity in its direction of motion, and oscillations of the animal’s head perpendicular to that direction. To filter out these oscillations, we projected the movement vector onto the animal’s facing direction, i.e. the vector from the grinder of the pharynx to its metacorpus (computed from the stage-tracking neural network output). The result of this projection is a signed scalar, which is reported as the animal’s velocity.
  Group /processing/CalciumActivity (ProcessingModule) Calcium time series metadata, segmentation, and fluorescence data
  Group /processing/CalciumActivity/CalciumSeriesSegmentation (ImageSegmentation) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates (PlaneSegmentation) Neuron center coordinates in aligned space
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/ID_labels (VectorData) Neuron Names | shape = (126,) | dtype = object
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/id (ElementIdentifiers)  | shape = (126,) | dtype = int64
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane (ImagingVolume) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/voxel_mask (VectorData) Voxel masks for each ROI | shape = (126,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/CalciumActivity/CalciumSeriesSegmentation/Aligned_neuron_coordinates/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (126,) | dtype = uint8
  Group /processing/CalciumActivity/NeuronIDs (SegmentationLabels) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation (ImageSegmentation) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates (PlaneSegmentation) Neuron center coordinates in aligned space
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/ID_labels (VectorData) Neuron Names | shape = (126,) | dtype = object
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/id (ElementIdentifiers)  | shape = (126,) | dtype = int64
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane (ImagingVolume) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/voxel_mask (VectorData) Voxel masks for each ROI | shape = (126,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/CalciumActivity/NeuronIDs/ImageSegmentation/Aligned_neuron_coordinates/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (126,) | dtype = uint8
  Group /processing/CalciumActivity/SignalCalciumImResponseSeries (RoiResponseSeries) Raw calcium fluorescence activity
  Dataset /processing/CalciumActivity/SignalCalciumImResponseSeries/rois (DynamicTableRegion) Segmented neurons associated with calcium image series | shape = (126,) | dtype = int64
  Group /processing/CalciumActivity/SignalRawFluor (Fluorescence) 
  Group /processing/CalciumActivity/SignalRawFluor/SignalCalciumImResponseSeries (RoiResponseSeries) Raw calcium fluorescence activity
  Dataset /processing/CalciumActivity/SignalRawFluor/SignalCalciumImResponseSeries/rois (DynamicTableRegion) Segmented neurons associated with calcium image series | shape = (126,) | dtype = int64
  Group /processing/NeuroPAL (ProcessingModule) NeuroPAL image metadata and segmentation
  Group /processing/NeuroPAL/NeuroPALSegmentation (ImageSegmentation) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons (PlaneSegmentation) Centers of NeuroPAL volume.
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/ID_labels (VectorData) Neuron Names | shape = (67,) | dtype = object
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/ROI_IDs (VectorData) ROI ID labels from segmentation image mask. | shape = (67,) | dtype = int64
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/id (ElementIdentifiers)  | shape = (67,) | dtype = int64
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane (ImagingVolume) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/voxel_mask (VectorData) Voxel masks for each ROI | shape = (67,) | dtype = [('x', '<u4'), ('y', '<u4'), ('z', '<u4'), ('weight', '<f4')]
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuroPALNeurons/voxel_mask_index (VectorIndex) Index for VectorData 'voxel_mask' | shape = (67,) | dtype = uint8
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs (PlaneSegmentation) Segmentation of NeuroPAL volume. IDs found in NeuroPALNeurons.
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/id (ElementIdentifiers)  | shape = (1,) | dtype = int64
  Dataset /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/image_mask (VectorData) Image masks for each ROI | shape = (1, 211, 97, 53) | dtype = uint16
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane (ImagingVolume) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/GCaMP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/OFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/TagRFP (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/device (Device) The light path used to image GCaMP, mNeptune, and the fluorophores in NeuroPAL at single cell resolution is an Andor spinning disk confocal system with Nikon ECLIPSE Ti microscope. Light supplied from a 150 mW 488 nm laser, 50 mW 560 nm laser, 100 mW 405 nm laser, or 140 mW 637 nm laser passes through a 5000 rpm Yokogawa CSU-X1 spinning disk unit with a Borealis upgrade (with a dual-camera configuration). A 40x water immersion objective (CFI APO LWD 40X WI 1.15 NA LAMBDA S, Nikon) with an objective piezo (P-726 PIFOC, Physik Instrumente (PI)) was used to image the volume of the worm’s head (a Newport NP0140SG objective piezo was used in a subset of the recordings). A custom quad dichroic mirror directed light emitted from the specimen to two separate sCMOS cameras (Zyla 4.2 PLUS sCMOS, Andor), which had in-line emission filters (525/50 for GcaMP/GFP, and 610 longpass for mNeptune2.5; NeuroPAL filters described below). Data was collected at 3 × 3 binning in a 322 × 210 region of interest in the center of the field of view, with 80 z planes collected at a spacing of 0.54 um. This resulted in a volume rate of 1.7 Hz (1.4 Hz for the datasets acquired with the Newport piezo).
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/mNeptune (OpticalChannelPlus) 
  Group /processing/NeuroPAL/NeuroPALSegmentation/NeuronSegmentationROIs/imaging_plane/order_optical_channels (OpticalChannelReferences) 
  session_description: Ventral cord at the bottom; one row of eggs
  Bouts of pumping at baseline, but not sustained at a high level; lots of pumping variance :D
  Heat stim given at t~802; pumping goes down to near-zero till the end of the recording
  Stage jitters t~1070 and again t~1280, might miss a few frames intermittently
  Both behavioral and neural data look different to the eye before versus after the stim
  
  session_start_time: 2022-12-21T00:00:00-08:00
  timestamps_reference_time: 2022-12-21T00:00:00-08:00
